{% extends "base.html.twig" %}

{% block content %}
    <div class="container">

        {% if user is defined and user is not null %}
            {% set participants = commonground_resource_list({'component': 'edu', 'type': 'participants'},{'person' : user['@id']})['hydra:member'] %}
            {% if participants|length > 0 %}
                {% set participant = participants[0] %}
            {% endif %}
        {% endif %}

        <!-- the alert box -->

        <div class="container">
            <section class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-xs-12">
                    <div class="content">
                        {% if test.course is defined and test.course is not empty %}
                            <a class="backlink" href="{{ path('app_education_course', {id: test.course.id}) }}">{{ test.course.name|capitalize }}</a>
                        {% endif %}
                        {% if test.activity is defined and test.activity is not empty %}
                            <a class="backlink" href="{{ path('app_education_activity', {id: test.activity.id}) }}">{{ test.activity.name|capitalize }}</a>
                        {% endif %}
                        <header class="content__header">
                            <h1 class="content__header-title">{{ test.name|capitalize }}</h1>
                        </header>
                    </div>
                </div>
            </section>

            <article>
                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12">
                        <div class="content-background">
                            <div class="content">
                                {% if test.description is defined and test.description is not empty %}
                                    <div class="edit-section">
                                        <h2>Beschrijving</h2>
                                    </div>
                                    <p>{{ test.description }}</p>
                                {% endif %}
                            </div>
                        </div>

                        {% if test.stages is defined and test.stages is not empty %}
                            <div style="height:20px;"></div>
                            {% for stage in test.stages %}

                                <div class="collapse" role="status">
                                    <div x-uno-collapse="" class="collapse__header">
                                        <i class="collapse__indicator">
                                            <span class="screenreader-only" data-contracted-i18n="ingeklapt" data-expanded-i18n="uitgeklapt"></span>
                                        </i>
                                        <span class="collapse__title">{{ stage.name }}</span>
                                    </div>
                                    <div class="collapse__details collapse__details--closed">
                                        {% if stage.description is defined and stage.description is not empty %}
                                            <h2>{{ stage.description }}</h2>
                                        {% endif %}

                                        {% if stage.questions is defined and stage.questions is not empty %}
                                            <form method="post" action="{{ path('app_education_test', {id: test.id}) }}">
                                                {% for question in stage.questions %}
                                                    <div class="input">
                                                        <h3>{{ question.name }}</h3>
                                                        <label class="input__label" for="description">{{ question.description }}</label>
                                                        {% if question.answerOptions is defined and question.answerOptions is not empty %}
                                                            <fieldset class="input">
                                                                {% for answerOption in question.answerOptions %}
                                                                    <div class="input__group input__group--radio">
                                                                        <input type="radio" name="{{ question.id }}" id="{{ question.id }}_{{ answerOption }}" class="input__control input__control--radio">
                                                                        <label class="input__label input__label--radio input__control--l" for="{{ question.id }}_{{ answerOption }}">{{ answerOption }}</label>
                                                                    </div>
                                                                {% endfor %}
                                                            </fieldset>
                                                        {% else %}
                                                            <input id="antwoord" type="text" class="input__control input__control--l input__control--search">
                                                        {% endif %}
                                                    </div>
                                                {% endfor %}

                                                <div class="input">
                                                    <button type="submit" class="btn">Verzenden <i class="icon icon-arr-forward"></i></button>
                                                </div>
                                            </form>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </article>
        </div>
    </div>

    <script>
        // Load collapse component
        System.import('/uno/components/collapse/collapse.js').then(function (module) {
            // Select all collapsible elements on the page
            var collapses = document.querySelectorAll('[x-uno-collapse]');
            // Initialize all collapses
            for (var i = 0; i < collapses.length; i++) {
                new module.Collapse(collapses.item(i));
            }
        });
    </script>

{% endblock %}
