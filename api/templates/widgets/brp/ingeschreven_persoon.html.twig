<div class="content-background">
    <div class="content">
        <script>
            /* Load tab component */
            System.import('/uno/components/tabs/tabs.js').then(function (module) {
                /* Select all .tab elements on the page */
                var tabs = document.querySelectorAll('.tab');
                /* Initialize all tabs */
                for (var i = 0; i < tabs.length; i++) {
                    new module.Tabs(tabs.item(i));
                }
            });
        </script>
        {% set ingeschrevenpersonen = commonground_resource_list({'component':'brp', 'type':'ingeschrevenpersonen'})['hydra:member'] %}


        {% if request.properties.overledene is defined and request.properties.overledene is not empty %}
            {% set selectedPersoon = commonground_resource(request.properties.overledene) %}
        {% endif %}
        <script>
            var ingeschrevenpersonen = [

                {% for ingeschrevenpersoon in ingeschrevenpersonen %}
                {
                    bsn: '{{ ingeschrevenpersoon['burgerservicenummer'] }}',
                    voornamen: '{{ ingeschrevenpersoon['naam']['voornamen'] }}',
                    geslachtsnaam: '{{ ingeschrevenpersoon['naam']['geslachtsnaam'] }}',
                    {% if ingeschrevenpersoon['geboorte']['datum']['date'] is defined %}
                    geboortedatum: '{{ ingeschrevenpersoon['geboorte']['datum']['date'] }}',
                    {% else %}
                    geboortedatum: '',
                    {% endif %}
                    url: '{{ ingeschrevenpersoon['@id'] }}'
                },
                {% endfor %}
            ];
        </script>
        <script>
            function FindBsn() {
                var selectedbsn = document.getElementById("bsn").value;
                var selectedIngeschrevenpersoonBsn = "";

                for (var i = 0; i < ingeschrevenpersonen.length;i++) {
                    if(ingeschrevenpersonen[i]['bsn'] == selectedbsn){
                        selectedIngeschrevenpersoonBsn = ingeschrevenpersonen[i]['url'];
                        document.getElementById("p_bsn").innerHTML = "bsn: " + ingeschrevenpersonen[i]['bsn'];
                        document.getElementById("p_naam").innerHTML = "naam: " + ingeschrevenpersonen[i]['voornamen'] + " " + ingeschrevenpersonen[i]['geslachtsnaam'];
                        document.getElementById("p_geboortedatum").innerHTML = "geboortedatum: " + ingeschrevenpersonen[i]['geboortedatum'];
                        break;
                    }
                }
                if(selectedIngeschrevenpersoonBsn == "")
                {
                    alert("BSN niet gevonden!");
                }

                var selectedIngeschrevenpersoon = document.getElementById("selectedIngeschrevenpersoon");
                selectedIngeschrevenpersoon.value = selectedIngeschrevenpersoonBsn;
            }
        </script>

        <h2>{{ property.title }}</h2>

        <!-- Page Break -->
        <div style="height: 20px;"></div>
        <div class="tab__content tab__content--inline">

            <section class="tab__pane tab__pane--active" id="panel2-1" role="tabpanel" aria-labelledby="tab2-1">
                <h3>Zoek op Burgerservicenummer</h3>
                <div class="input input--horizontal">

                    <input type="text" id="bsn" aria-describedby="hint_name" class="input__control input__control--text input__control--s">
                </div>
                <div class="input">
                    <button type="button" onclick="FindBsn()" class="btn btn--primary"  value="bsn">Zoeken</button>
                </div>

                <div>
                    <p id="p_bsn">bsn: </p>
                    <p id="p_naam">naam: </p>
                    <p id="p_geboortedatum">geboortedatum: </p>
                </div>
                <script>
                    {% if selectedPersoon is defined %}
                    document.getElementById("p_bsn").innerHTML = "bsn: {{ selectedPersoon['burgerservicenummer'] }}";
                    document.getElementById("p_naam").innerHTML = "naam: {{ selectedPersoon['naam']['voornamen'] }} {{ selectedPersoon['naam']['geslachtsnaam'] }}";

                    {% for ingeschrevenpersoon in ingeschrevenpersonen %}

                    {% endfor %}
                    {% endif %}
                </script>

            </section>
        </div>

        <input type="hidden" id="selectedIngeschrevenpersoon" name="request[properties][{{ property.name }}]">

        {#
                <form class="form" method="post" action="#">
                    <div class="input">
                        <button type="submit" class="btn" name="submit" value="save">Opslaan</button> of naar de <a href="{{ path('app_begrafenisplannen_artikelen') }}">vorige stap</a>
                    </div>
                </form>
        #}
    </div><!-- /.content -->
</div><!-- /.content-background -->
